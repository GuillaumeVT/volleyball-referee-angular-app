<div class="modal-header">
  <h5 class="modal-title vbr-text" *ngIf="game && crudType && (crudType === 1)">Create game</h5>
  <h5 class="modal-title vbr-text" *ngIf="game && crudType && (crudType === 2)">Update game</h5>
  <h5 class="modal-title vbr-text" *ngIf="game && crudType && (crudType === 4)">View game</h5>
  <button type="button" class="close" aria-label="Close" (click)="close()">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<div class="modal-body" *ngIf="game && crudType">
  <form class="needs-validation" (submit)="onSubmitForm()" novalidate autocomplete="off">
    <div class="row mb-3">
      <div class="col-12 col-sm-10">
        <label class="vbr-text" for="schedule">Scheduled for</label>
        <input class="form-control vbr-text-color" name="schedule" id="schedule" [owlDateTime]="dtp" [owlDateTimeTrigger]="dtp" [(ngModel)]="scheduleDate" [min]="minScheduleDate"
          (keydown)="$event.preventDefault()" required [attr.disabled]="isEditingDisabled()">
        <owl-date-time #dtp></owl-date-time>
      </div>
    </div>

    <div class="mb-3">
      <div class="custom-control custom-radio custom-control-inline">
        <input class="custom-control-input" type="radio" name="indexed" id="public" [value]="true" [(ngModel)]="game.indexed" [attr.disabled]="isEditingDisabled()">
        <label class="custom-control-label vbr-text" name="public" for="public">Public</label>
      </div>
      <div class="custom-control custom-radio custom-control-inline">
        <input class="custom-control-input" type="radio" name="indexed" id="private" [value]="false" [(ngModel)]="game.indexed" [attr.disabled]="isEditingDisabled()">
        <label class="custom-control-label vbr-text" name="private" for="private">Private</label>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-12 col-sm-10">
        <label class="vbr-text" for="league">Tournament / League</label>
        <input type="text" class="vbr-text form-control" name="league" id="league" list="leagueList" [(ngModel)]="game.league" required [attr.disabled]="isEditingDisabled()"/>
        <datalist id="leagueList">
          <option *ngFor="let league of leagues" [ngValue]="league.name">{{league.name}}</option>
        </datalist>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-12 col-sm-10">
        <label class="vbr-text" for="division">Pool / Division</label>
        <input type="text" class="vbr-text form-control" name="division" id="division" list="divisionList" [(ngModel)]="game.division" required [attr.disabled]="isEditingDisabled()"/>
        <datalist id="divisionList">
          <option *ngFor="let division of divisions" [ngValue]="division">{{division}}</option>
        </datalist>
      </div>
    </div>

    <div class="row align-items-center mb-3">
      <div class="col-6 col-sm-4">
        <label [ngClass]="invalidGender ? 'vbr-error-label' : ''" class="vbr-text">Gender</label>
      </div>
      <div class="col-6 col-sm-8">
        <button type="button" class="btn form-button" [ngClass]="getGenderButton()" id="gender" (click)="nextGender()" [attr.disabled]="(crudType === 2 || crudType === 4) ? true : null">
          <i class="p-1" [ngClass]="getGenderIcon()"></i>
        </button>
      </div>
      <div class="col-12">
        <div class="vbr-error-feedback" *ngIf="invalidGender">
          Teams gender and game gender must be identical.
        </div>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-12 col-sm-10">
        <label [ngClass]="invalidHTeam ? 'vbr-error-label' : ''" class="vbr-text" for="hTeam">Home team</label>
        <select [ngClass]="invalidHTeam ? 'vbr-error-input' : ''" class="vbr-text custom-select" name="hTeam" id="hTeam" [(ngModel)]="game.hName" [attr.disabled]="isEditingDisabled()">
          <option *ngFor="let team of teams" [ngValue]="team.name">{{team.name}}&nbsp;&nbsp;{{utils.getGenderNoIcon(team.gender)}}</option>
        </select>
      </div>
      <div class="col-12">
        <div class="vbr-error-feedback" *ngIf="invalidTeams">
          Home and guest teams must be different.
        </div>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-12 col-sm-10">
        <label [ngClass]="invalidGTeam ? 'vbr-error-label' : ''" class="vbr-text" for="gTeam">Guest team</label>
        <select [ngClass]="invalidGTeam ? 'vbr-error-input' : ''" class="vbr-text custom-select" name="gTeam" id="gTeam" [(ngModel)]="game.gName" [attr.disabled]="isEditingDisabled()">
          <option *ngFor="let team of teams" [ngValue]="team.name">{{team.name}}&nbsp;&nbsp;{{utils.getGenderNoIcon(team.gender)}}</option>
        </select>
      </div>
      <div class="col-12">
        <div class="vbr-error-feedback" *ngIf="invalidTeams">
          Home and guest teams must be different.
        </div>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-12 col-sm-10">
        <label [ngClass]="invalidRules ? 'vbr-error-label' : ''" class="vbr-text" for="rules">Rules</label>
        <select [ngClass]="invalidRules ? 'vbr-error-input' : ''" class="vbr-text custom-select" name="rules" id="rules" [(ngModel)]="game.rules" [attr.disabled]="isEditingDisabled()">
          <optgroup label="Default Rules">
            <option *ngFor="let rule of defaultRules" [ngValue]="rule.name">{{rule.name}}</option>
          </optgroup>
          <optgroup label="My Rules">
            <option *ngFor="let rule of rules" [ngValue]="rule.name">{{rule.name}}</option>
          </optgroup>
        </select>
      </div>
      <div class="col-12">
        <div class="vbr-error-feedback" *ngIf="invalidRules">
          Please select the rules.
        </div>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-12 col-sm-10">
        <label class="vbr-text" for="referee">Referee</label>
        <input type="text" class="vbr-text form-control" name="referee" id="referee" [(ngModel)]="game.referee" required [attr.disabled]="isEditingDisabled()"/>
      </div>
    </div>

    <div class="row mb-3" *ngIf="invalidResponse">
      <div class="col-12 col-sm-10">
        <p class="alert alert-danger" *ngIf="crudType === 1">
          The game could not be created.
        </p>
        <p class="alert alert-danger" *ngIf="crudType === 2">
          The game could not be updated. Is it live or completed?
        </p>
      </div>
    </div>

    <div class="modal-footer">
      <button type="button" class="btn cancel-button" *ngIf="crudType === 4" (click)="close()">Close</button>
      <button type="button" class="btn cancel-button" *ngIf="crudType !== 4" (click)="close()">Cancel</button>
      <button type="submit" class="btn vbr-button" *ngIf="crudType === 1">Create</button>
      <button type="submit" class="btn vbr-button" *ngIf="crudType === 2">Update</button>
    </div>
  </form>
</div>
